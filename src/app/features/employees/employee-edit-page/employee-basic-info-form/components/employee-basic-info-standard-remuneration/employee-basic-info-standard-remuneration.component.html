<div class="form-section" [formGroup]="form">
  <h3>標準報酬</h3>

  <!-- 月次報酬入力画面からの自動算出結果（参考情報） -->
  <div
    class="card"
    style="margin-bottom: 1.5rem; padding: 1rem; background-color: #f8f9fa"
  >
    <h4 style="margin-top: 0">月次報酬入力画面からの自動算出結果</h4>
    <div style="display: flex; gap: 1rem; margin-bottom: 1rem">
      <button
        type="button"
        (click)="loadCalculationResults()"
        class="btn-secondary"
        [disabled]="isLoading"
      >
        {{ isLoading ? "読み込み中..." : "計算結果を更新" }}
      </button>
    </div>

    <!-- 最新の標準報酬履歴の結果 -->
    <div
      *ngIf="latestHistory"
      style="
        margin-bottom: 1rem;
        padding: 0.75rem;
        background-color: white;
        border-radius: 4px;
        border: 1px solid #ddd;
      "
    >
      <h5 style="margin-top: 0">
        {{
          getDeterminationReasonLabelForHistory(
            latestHistory.determinationReason
          )
        }}
        （{{ latestHistory.applyStartYear }}年{{
          latestHistory.applyStartMonth
        }}月適用開始）
      </h5>
      <div style="font-size: 0.9rem; margin-bottom: 0.5rem">
        <div>
          <strong>標準報酬月額:</strong>
          {{ latestHistory.standardMonthlyRemuneration.toLocaleString() }}円
        </div>
        <div *ngIf="latestHistory.grade">
          <strong>等級:</strong> {{ latestHistory.grade }}等級
        </div>
        <div *ngIf="latestHistory.memo">
          <strong>備考:</strong> {{ latestHistory.memo }}
        </div>
      </div>
    </div>

    <div
      *ngIf="!latestHistory && !isLoading"
      style="color: #666; font-size: 0.9rem"
    >
      標準報酬履歴が登録されていません。
    </div>
  </div>

  <!-- 手動入力欄 -->
  <div class="form-group">
    <label for="currentStandardMonthlyRemuneration">現在の標準報酬月額</label>
    <input
      id="currentStandardMonthlyRemuneration"
      type="number"
      formControlName="currentStandardMonthlyRemuneration"
      class="form-control"
      min="0"
      placeholder="円"
      readonly
    />
  </div>

  <div class="form-group">
    <label for="determinationReason">決定理由</label>
    <input
      id="determinationReason"
      type="text"
      [value]="getDeterminationReasonLabel()"
      class="form-control"
      readonly
      style="background-color: #f5f5f5; cursor: not-allowed"
    />
    <!-- フォームの値として保持するため、hidden inputで値を保持 -->
    <input type="hidden" formControlName="determinationReason" />
  </div>
</div>
