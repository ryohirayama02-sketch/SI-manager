<div class="info-label">
  <strong>重要:</strong> 4〜6月の値は算定基礎届の判定に使用されます。給与項目ごとに金額を入力してください。
</div>

<div class="card" style="max-width: 400px;">
  <div class="form-group">
    <label>都道府県：</label>
    <select [value]="prefecture" (change)="onPrefectureChange($event)" name="prefecture" class="form-control">
      <option value="tokyo">東京都</option>
      <option value="hokkaido">北海道</option>
      <option value="osaka">大阪府</option>
    </select>
  </div>
</div>

<div class="legend">
  ■ 復職後3ヶ月の期間（随時改定が発生しやすい期間）
</div>

<div *ngIf="salaryItems.length === 0" class="error-box">
  <h4>エラー</h4>
  <p>先に給与項目マスタを設定してください。</p>
</div>

<div *ngIf="salaryItems.length > 0" class="salary-table-wrapper">
  <table class="salary-table">
    <thead>
      <tr>
        <th class="sticky-col">従業員</th>
        <th class="sticky-col">項目</th>
        <th *ngFor="let m of months" [ngClass]="{ 'rehab-highlight': false }">{{ m }}月</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let emp of employees">
        <tr *ngFor="let item of salaryItems; let itemIndex = index" [ngClass]="{ 'rehab-highlight-row': getRehabHighlightMonths(emp).length > 0 && itemIndex === 0 }">
          <td class="sticky-col" *ngIf="itemIndex === 0" [attr.rowspan]="salaryItems.length">
            {{ emp.name }}
          </td>
          <td class="sticky-col">
            {{ item.name }}
            <small style="display: block; color: #666;">({{ item.type === 'fixed' ? '固定' : '非固定' }})</small>
          </td>
          <td *ngFor="let m of months" [ngClass]="{ 'rehab-highlight': getRehabHighlightMonths(emp).includes(m) }">
            <input
              type="number"
              [value]="getSalaryItemAmount(emp.id, m, item.id)"
              (input)="onSalaryItemChange(emp.id, m, item.id, $any($event.target).value)"
              placeholder="0"
              class="form-control"
              [name]="'item_' + emp.id + '_' + m + '_' + item.id"
              min="0"
              step="1"
            />
          </td>
        </tr>
      </ng-container>
    </tbody>
  </table>
</div>

